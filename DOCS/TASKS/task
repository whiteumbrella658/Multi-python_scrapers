Each time i will call you y will send you a customer id and you will have to scrape all the access of this customer.
To obtain all the access of each customer you haver the stored procedure (sp)

CustomerFinancialEntityAccess. (EXEC dbo.CustomerFinancialEntityAccess @CustomerID=58056)

So fist step is to parallel scrape all the access available for the customer provided by parameter. Actually only available scrapes.
I will provide you the function to integrate the movements for tomorrow.

CustomerFinancialEntityAccess provides you all the required information to scrape each access
Other functionsactually available,

Customer (EXEC dbo.Customer @CustomerID=Null)

and

FinancialEntity (EXEC dbo.FinancialEntity @FinancialEntityId=Null).

To obtain the list of both entities.